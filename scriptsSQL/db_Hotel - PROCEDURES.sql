/* 
CREACION DE PROCEDIMIENTOS db_AgenciaInmobiliaria
INTEGRANTES:
- KEVIN ALAN FLORES REYNA - 20660053
- ANGEL DAVID LOPEZ ALVAREZ - 20660062
*/


/* PROCEDIMIENTO UTILIZADO PARA CONTROLAR EL ACCESO AL PROGRAMA */
CREATE DEFINER=`root`@`localhost` PROCEDURE `LOGINrec`(
	IN `emp` VARCHAR(10),
	IN `pass` VARCHAR(16)
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA CONTROLAR EL ACCESO AL PROGRAMA'
SELECT COUNT(recID) AS isExist
FROM Recepcionista
WHERE (recID LIKE emp) AND (passRec LIKE pass);

/* PROCEDIMIENTO UTILIZADO PARA AGREGAR VALORES A LA TABLA PRODUCTOS */
CREATE DEFINER=`root`@`localhost` PROCEDURE `ADDproduct`(
	IN `codProductoP` INT(4),
	IN `nomProductP` VARCHAR(32),
	IN `unidadMedidaP` VARCHAR(4),
	IN `precioP` DECIMAL(7,2),
	IN `stockP` INT(3),
	IN `cantidadUMP` INT(4)
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA AGREGAR VALORES A LA TABLA PRODUCTOS'
INSERT INTO Producto (codProducto, nomProduct, unidadMedida, precio, stock, cantidadUM) 
VALUES (codProductoP,nomProductP,unidadMedidaP,precioP,stockP,cantidadUMP);

/* PROCEDIMIENTO UTILIZADO PARA BUSCAR TODOS LOS PRODUCTOS */
CREATE DEFINER=`root`@`localhost` PROCEDURE `SEARCHproduct`(
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA BUSCAR TODOS LOS PRODUCTOS'
SELECT codProducto, nomProduct, precio, stock, unidadMedida, cantidadUM
FROM producto
ORDER BY codProducto ASC;

/* PROCEDIMIENTO UTILIZADO PARA BUSCAR PRODUCTOS DE FORMA AISLADA*/
CREATE DEFINER=`root`@`localhost` PROCEDURE `SEARCHproductUNIQUE`(
	IN `codProductoP` INT(4)
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA BUSCAR LOS PRODUCTOS DE FORMA AISLADA'
SELECT codProducto, nomProduct, precio, stock, unidadMedida, cantidadUM
FROM Producto
WHERE (codProducto = codProductoP);

/* PROCEDIMIENTO UTILIZADO PARA AGREGAR VALORES A LA TABLA RECEPCIONISTA */
CREATE DEFINER=`root`@`localhost` PROCEDURE `ADDrecep`(
	IN `recIDR` VARCHAR(10),
	IN `nomRecR` VARCHAR(24),
	IN `apRecR` VARCHAR(16),
	IN `amRecR` VARCHAR(16),
	IN `calleRecR` VARCHAR(21),
	IN `numExtRecR` INT(3),
	IN `colRecR` VARCHAR(15),
	IN `cpRecR` INT(5),
	IN `ciudadRecR` VARCHAR(15),
	IN `rolRecR` VARCHAR(6),
	IN `passRecR` VARCHAR(16)
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA AGREGAR VALORES A LA TABLA RECEPCIONISTA'
INSERT INTO Recepcionista (recID,nomRec,apRec,amRec,calleRec,numExtRec,colRec,cpRec,ciudadRec,rolRec,passRec) 
VALUES (recIDR,nomRecR,apRecR,amRecR,calleRecR,numExtRecR,colRecR,cpRecR,ciudadRecR,rolRecR,passRecR);

/* PROCEDIMIENTO UTILIZADO PARA BUSCAR TODOS LOS RECEPCIONISTAS */
CREATE DEFINER=`root`@`localhost` PROCEDURE `SEARCHrecep`(
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA BUSCAR TODOS LOS RECEPCIONISTAS'
SELECT recID, rolRec, nomRec, apRec, amRec, CONCAT(calleRec," #",numExtRec," col. ",colRec,"CP. ",cpRec,", ", ciudadRec) AS dirRec
FROM Recepcionista
ORDER BY recID ASC;

/* PROCEDIMIENTO UTILIZADO PARA BUSCAR RECEPCIONISTAS DE FORMA AISLADA*/
CREATE DEFINER=`root`@`localhost` PROCEDURE `SEARCHrecepUNIQUE`(
	IN `id` VARCHAR(10)
)
LANGUAGE SQL
NOT DETERMINISTIC
CONTAINS SQL
SQL SECURITY DEFINER
COMMENT 'PROCEDIMIENTO UTILIZADO PARA BUSCAR TODOS LOS RECEPCIONISTAS SEGUN SU ID'
SELECT recID, rolRec, nomRec, apRec, amRec, passRec, calleRec, numExtRec, colRec, cpRec, ciudadRec
FROM recepcionista
WHERE (recID LIKE id);
